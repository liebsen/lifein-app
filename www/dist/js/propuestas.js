;var currentnode='/propuestas/'+key,propuestas=firebase.database().ref(currentnode),datosdeapoyo={},anim=LI.animation.transition,show=function(e){$('body').attr('key',e);LI.setScroll();$('.spinner').fadeIn(anim.fadeIn*anim.factor,function(){firebase.database().ref(currentnode+'/'+e).once('value').then(function(e){var n=e.val(),i=[],a=0,o={};var t=0;return new Promise(function(e,d){a=Object.keys(n.escrutinio).length||0;t=a;if(a){for(var r in n.escrutinio){o[t]=n.escrutinio[r];t--;firebase.database().ref('cuentas/'+key+'/'+n.escrutinio[r].usuario_id).once('value').then(function(n){o[a].user=n.val();i.push(o[a]);a--;if(a===0){e(i)}})}}
else{e(null)}}).then(function(a){$('#detail').html($.templates('#form').render({key:e.key,data:n,resultados:a},LI.aux)).promise().done(function(){$('.lista').fadeOut(anim.fadeOut,function(){$('.spinner').fadeOut(anim.fadeOut*anim.factor,function(){$('#detail').delay(200).fadeIn(anim.fadeOut*anim.factor,function(){$('body,html').scrollTop(0)})})})})})})})};propuestas.once('value').then(function(e){if(!e.val()){$('.spinner').fadeOut(anim.fadeOut,function(){$('.lista').delay(anim.delay).fadeIn()})}});firebase.database().ref('/datosdeapoyo').once('value').then(function(e){datosdeapoyo=e.val()});$(document).on('submit','#firebase-form',function(e){e.preventDefault();var a=$(this).serializeObject(),t={},o=$(this).attr('key'),i=a.comment;delete a.comment;a.aprobado=a.aprobado?1:0;for(var n in a){t[currentnode+'/'+o+'/'+n]=a[n]};$('.spinner').fadeIn(anim.fadeIn,function(){firebase.database().ref(currentnode+'/'+o).once('value').then(function(e){var n=e.val(),o=n.aprobado;firebase.database().ref().update(t,function(e){if(e){console.log(e)}
else{LI.notify({status_ref:o||0,status:a.aprobado,type:'alerta',user_id:'all',title:'Propuesta',text:i});LI.resetScroll();$('.spinner').fadeOut(anim.fadeOut*anim.factor,function(){location.hash=''})}})})});return!1});$(document).on('click','.add-item',function(e){$('#detail').html($.templates('#form').render({key:null,data:{aprobado:''},aux:LI.aux,datosdeapoyo:datosdeapoyo},LI)).promise().done(function(){$('.lista').fadeOut(anim.fadeOut,function(){$('#detail').delay(200).fadeIn(anim.fadeOut*anim.factor,function(){$('body,html').scrollTop(0)})})})});$(document).on('click','.action.eliminar',function(){var e=$(this).data('key');swal({title:'Borrar reserva',text:'Seguro que querÃ©s eliminar esta reserva?',type:'warning',showCancelButton:!0,closeOnConfirm:!1,showLoaderOnConfirm:!0,},function(){firebase.database().ref(currentnode+e).remove().then(function(){swal.close()})})});$(document).on('click','.cerrar',function(){location.hash=''});$(function(){$(window).on('hashchange',function(){if(location.hash!=''){show(location.hash.replace('#',''))}
else{$('#detail').fadeOut(anim.fadeOut,function(){$('.lista').delay(anim.delay).fadeIn(anim.fadeIn,function(){LI.resetScroll()})})}}).trigger('hashchange')});propuestas.on('child_added',(data)=>{$('#list').prepend($.templates('#item').render({key:data.key,data:data.val()},LI.aux)).promise().done(function(){$('#list').find('#'+data.key).animateAdded()});if(location.hash===''){$('.spinner').fadeOut(anim.fadeOut)}});propuestas.on('child_changed',(data)=>{var index=$('#'+data.key).index();$('#'+data.key).remove();$('#list').insertAt(index,$.templates('#item').render({key:data.key,data:data.val()}));$('#'+data.key).animateChanged()});propuestas.on('child_removed',(data)=>{$('#'+data.key).animateRemoved(function(){$(this).remove()})});